angular.module("jmdApp",["LocalStorageModule","ngRoute","jmd.resources","jmd.controllers","jmd.filters","jmd.tripSelector","jmd.dateSelector","jmd.roomSelector","jmd.tourSelector","ngAnimate"]).config(["$routeProvider",function(a){a.when("/:tripName/select",{templateUrl:"app/partials/select.html"}).when("/:tripName/extras",{templateUrl:"app/partials/extras.html"}).when("/:tripName/guests",{templateUrl:"app/partials/guests.html"}).when("/:tripName/payment",{templateUrl:"app/partials/payment.html"}).when("/:tripName/confirmation",{templateUrl:"app/partials/confirmation.html"}).otherwise({redirectTo:"/passport-to-the-world/select"})}]),angular.module("jmd.controllers",[]).controller("jmdBookingEngineController",["$location","$scope","SharedResource","localStorageService","$rootScope","$route",function(a,b,c,d,e){b.SharedResource=c,b.pages=[{label:"select"},{label:"extras"},{label:"guests"},{label:"payment"},{label:"confirmation"}],e.$on("$routeChangeStart",function(){$("html, body").animate({scrollTop:0},200)}),b.$watch("SharedResource.sharedData",function(a,c){a&&a!==c&&d.set(b.tripName,a)},!0),e.$on("$routeChangeSuccess",function(){b.tripName=a.path().split("/")[1],b.currentPage=a.path().split("/")[2];for(var c=0,d=b.pages.length;d>c;c++)if(b.pages[c].label===b.currentPage){b.currentPageIndex=c,b.prevPage=b.pages[c-1],b.nextPage=b.pages[c+1];break}b.currentPageIndex>-1&&(b.init||(b.init=!0,b.SharedResource.getTrip(b.tripName))),b.currentPageIndex>0,b.currentPageIndex>2,b.currentPageIndex===b.pages.length})}]),angular.module("jmd.dateSelector",[]).controller("jmdDateSelectorCtrl",["$scope","SharedResource",function(a,b){a.SharedResource=b,a.changeDate=function(a){for(var c=0,d=b.sharedData.trip.dates.length;d>c;c++)b.sharedData.trip.dates[c].selected=!1;a.selected=!0},a.init=function(){a.changeDate(b.sharedData.trip.dates[0])},a.SharedResource.sharedData.trip&&!a.SharedResource.sharedData.trip.dateSelected?a.init():a.$watch("SharedResource.sharedData.trip.dates",function(b,c){b&&b!==c&&a.init()},!0)}]),angular.module("jmd.roomSelector",[]).controller("jmdRoomSelectorCtrl",["$scope","SharedResource",function(a,b){a.SharedResource=b,a.$watch("SharedResource.sharedData.trip.rooms",function(b){if(b){var c=0,d=0;a.SharedResource.sharedData.trip.guests=[];for(var e=0,f=a.SharedResource.sharedData.trip.rooms.length;f>e;e++){var g=a.SharedResource.sharedData.trip.rooms[e].selectedRoom;g.maxAdults=g.maxPeople-g.children,g.maxChildren=g.maxPeople-g.adults,g.totalGuests=g.adults+g.children,c+=g.totalGuests,d+=g.adults*g.perAdult,d+=g.children*g.perChild;for(var h=0,i=g.adults;i>h;h++)a.SharedResource.sharedData.trip.guests.push({title:"Mr",type:"adult"});for(var j=0,k=g.children;k>j;j++)a.SharedResource.sharedData.trip.guests.push({title:"Mr",type:"child"})}a.SharedResource.sharedData.trip.totalGuests=c,a.SharedResource.sharedData.trip.totalGuestCost=d,c>a.SharedResource.sharedData.trip.maxGroupSize&&$("html, body").animate({scrollTop:$(document).height()},500)}},!0),a.addRoom=function(b){var c=angular.copy(a.SharedResource.sharedData.trip.roomOptions);a.SharedResource.sharedData.trip.rooms.push({roomOptions:c,selectedRoom:c[0]}),b||$("html, body").animate({scrollTop:$(document).height()},500)},a.removeRoom=function(b){a.SharedResource.sharedData.trip.rooms.splice(b,1)},a.init=function(){a.SharedResource.sharedData.trip.rooms=[];for(var b=0,c=a.SharedResource.sharedData.trip.roomOptions.length;c>b;b++){var d=a.SharedResource.sharedData.trip.roomOptions[b];d.adults=1,d.children=0,d.maxAdults=d.maxPeople,d.maxChildren=d.maxPeople-1}a.addRoom(!0)},a.SharedResource.sharedData.trip&&!a.SharedResource.sharedData.rooms?a.init():a.$watch("SharedResource.sharedData.trip.roomOptions",function(b,c){b&&b!==c&&a.init()},!0)}]),angular.module("jmd.tourSelector",[]).controller("tourSelectorCtrl",["$scope","$location","SharedResource",function(a,b,c){a.SharedResource=c,a.changeTour=function(a){a.selected=!a.selected}}]),angular.module("jmd.tripSelector",[]).controller("jmdTripSelectorCtrl",["$scope","$location","SharedResource",function(a,b,c){a.SharedResource=c,a.sharedData=c.sharedData,a.changeTrip=function(){if(a.changeTripFlag=!a.changeTripFlag,a.changeTripFlag)a.SharedResource.getCountryTrips();else{var b=a.sharedData.countryTrips.selectedCountry.selectedTrip;b!==a.sharedData.trip.name&&a.SharedResource.getTrip(b.split(" ").join("-"))}},a.cancelTrip=function(){a.changeTripFlag=!1}}]),angular.module("jmd.filters",[]).filter("currency",["SharedResource","$filter",function(a,b){return function(c){var d=a.sharedData.selectedCurrency;return d?d.symbol+b("number")(Number(c*d.rate)):void 0}}]),angular.module("jmd.resources",[]).factory("SharedResource",["$http","$location","$timeout",function(a,b){var c={};return formatCountryTrips=function(a){angular.forEach(a.countries,function(b){b.name===c.trip.country?(a.selectedCountry=b,angular.forEach(b.trips,function(a){a===c.trip.name&&(b.selectedTrip=a)})):b.selectedTrip=b.trips[0],c.countryTrips=a})},getCountryTrips=function(){c.countryTrips=void 0,$("html, body").animate({scrollTop:0},500),a({method:"GET",url:"app/json/country-trips.json"}).success(function(a){formatCountryTrips(a)}).error(function(){alert("Sorry, an error occurred")})},formatTripData=function(a){$("html, body").animate({scrollTop:0},500),b.path(a.trip.name.split(" ").join("-")+"/select"),c.reloading=!1,c.currencies=a.currencies,c.selectedCurrency=a.currencies[0],c.trip=a.trip},getTrip=function(b,d){c.reloading=!0,d?formatTripData(d):a({method:"GET",url:"app/json/"+b+".json"}).success(function(a){formatTripData(a)}).error(function(){alert("Sorry, an error occurred")})},{sharedData:c,getTrip:getTrip,getCountryTrips:getCountryTrips}}]);
//# sourceMappingURL=main.min.js.map